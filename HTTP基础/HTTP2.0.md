### HTTP/2
与 HTTP/1.1 相比，HTTP/2 的主要变化在于性能提升。 
> 一些主要功能（例如复用、标头压缩、优先级和协议协商）

目前 HTTP/1.x 客户端需要使用多个连接才能实现并发和缩短延迟；
HTTP/1.x 不会压缩请求和响应标头，从而导致不必要的网络流量；HTTP/1.x 不支持有效的资源优先级，致使底层 TCP 连接的利用率低下；等等。

#### 技术目标

> HTTP/2 通过支持标头字段压缩和在同一连接上进行多个并发交换，让应用更有效地利用网络资源，减少感知的延迟时间。具体来说，它可以对同一连接上的请求和响应消息进行交错发送并为 HTTP 标头字段使用有效编码。 
> HTTP/2 还允许为请求设置优先级，让更重要的请求更快速地完成，从而进一步提升性能。

出台的协议更有利于网络，因为与 HTTP/1.x 相比，可以使用更少的 TCP 连接。 > 这意味着与其他流的竞争减小，并且连接的持续时间变长，这些特性反过来提高 了可用网络容量的利用率。 最后，HTTP/2 还可以通过使用二进制消息分帧对消息进行更高效 的处理。 （超文本传输协议版本 2，草案 17）


#### 二进制分帧层

HTTP 2.0 中所有加强性能的核心点在于此。在之前的 HTTP 版本中，我们是通过文本的方式传输数据。在 HTTP 2.0 中引入了新的编码机制，所有传输的数据都会被分割，并采用二进制格式编码

HTTP/2 所有性能增强的核心在于新的二进制分帧层，它定义了如何封装 HTTP 消息并在客户端与服务器之间传输。

![http2](../image/binary_framing_layer01.png"http2")


#### 数据流、消息和帧

帧头（标识所属的流） -> 帧 ->（多个帧） 消息 ->（一个或多个消息） 数据流

数据流是双向的，包含唯一的标识符 和 可选的优先级信息, 并且在一个tcp链接内复用

![http2](../image/multiplexing01.png"http2")

多个数据流在同一个tcp链接上交错发送，消除不必要的延迟和提高现有网络容量的利用率，从而减少页面加载时间。


#### 标头压缩

 在 HTTP/1.x 中，此元数据始终以纯文本形式，通常会给每个传输增加 500–800 字节的开销。如果使用 HTTP Cookie，增加的开销有时会达到上千字节。为了减少此开销和提升性能，HTTP/2 使用 HPACK 压缩格式压缩请求和响应标头元数据,标头数据大小减小 85% - 88%，显著减少了页面加载时间延迟。利用霍夫曼编码，可以在传输时对各个值进行压缩,而利用之前传输值的索引列表,索引值可用于有效查询和重构完整的标头键值对。


 #### 服务器推送

 HTTP/2 新增的另一个强大的新功能是，服务器可以对一个客户端请求发送多个响应，从而减少额外的延迟时间。当然在浏览器兼容的情况下你也可以使用 prefetch 。